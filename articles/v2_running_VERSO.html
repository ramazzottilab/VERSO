<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Running VERSO â€¢ VERSO</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Running VERSO">
<meta property="og:description" content="VERSO">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">VERSO</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v1_introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/v2_running_VERSO.html">Running VERSO</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BIMIB-DISCo/VERSO/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Running VERSO</h1>
                        <h4 data-toc-skip class="author">Daniele
Ramazzotti</h4>
                        <h4 data-toc-skip class="author">Fabrizio
Angaroni</h4>
                        <h4 data-toc-skip class="author">Davide
Maspero</h4>
                        <h4 data-toc-skip class="author">Alex
Graudenxi</h4>
                        <h4 data-toc-skip class="author">Luca De
Sano</h4>
                        <h4 data-toc-skip class="author">Gianluca
Ascolani</h4>
            
            <h4 data-toc-skip class="date">April 29, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BIMIB-DISCo/VERSO/blob/HEAD/vignettes/v2_running_VERSO.Rmd" class="external-link"><code>vignettes/v2_running_VERSO.Rmd</code></a></small>
      <div class="hidden name"><code>v2_running_VERSO.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="example-of-phylogenetic-inference-by-verso">Example of phylogenetic inference by VERSO<a class="anchor" aria-label="anchor" href="#example-of-phylogenetic-inference-by-verso"></a>
</h2>
<p>We now present an example of phylogenetic analysis by VERSO using
mutation data from a set of SARS-CoV-2 samples; the dataset includes
variants for a selected set of 15 SARS-CoV-2 samples obtained by variant
calling from raw data available from NCBI BioProject PRJNA610428.</p>
<p>We first load the data. Notice that the input data to VERSO is an
array reporting variants either observed (as 1 in the matrix), not
observed (as 0) or missing (as NA, i.e., due to low coverage).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/BIMIB-DISCo/VERSO" class="external-link">"VERSO"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">variants</span><span class="op">)</span></span></code></pre></div>
<p>We setup the main parameter in oder to perform the inference. The
first main parameter to be defined as input is represented by the false
positive and false negative error rates, i.e., alpha and beta. When
multiple set of rates are provided, VERSO performs a grid search in
order to estimate the best set of error rates.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.01 0.05</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.01 0.05</span></span></code></pre>
<p>We can now perform the inference as follow. Make sure to set the
random seed to ensure reproducibility.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="va">inference</span> <span class="op">=</span> <span class="fu"><a href="../reference/VERSO.html">VERSO</a></span><span class="op">(</span>D <span class="op">=</span> <span class="va">variants</span>, </span>
<span>                  alpha <span class="op">=</span> <span class="va">alpha</span>, </span>
<span>                  beta <span class="op">=</span> <span class="va">beta</span>, </span>
<span>                  check_indistinguishable <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                  num_rs <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                  num_iter <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                  n_try_bs <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                  num_processes <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We notice that the inference resulting on the command above should be
considered only as an example; the parameters num rs, num iter and n try
bs representing the number of steps perfomed during the inference are
downscaled to reduce execution time. We refer to the Manual for
discussion on default values. We provide within the package results of
the inference performed with the same parameters as RData.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">inference</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">inference</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "B"                    "C"                    "phylogenetic_tree"   </span></span>
<span><span class="co">## [4] "corrected_genotypes"  "genotypes_prevalence" "genotypes_summary"   </span></span>
<span><span class="co">## [7] "log_likelihood"       "error_rates"</span></span></code></pre>
<p>VERSO returns a list of 8 elements as results. Namely, B, C,
phylogenetic tree, corrected genotypes, genotypes prevalence, genotypes
summary, log likelihood and error rates. Here, B returns the maximum
likelihood variants tree (inner nodes of the phylogenetic tree), C the
attachment of patients to genotypes and phylogenetic tree VERSO
phylogenetic tree, including both variants tree and patients attachments
to variants; corrected genotypes is the corrected genotypes, which
corrects D given VERSO phylogenetic tree, genotypes prevalence the
number of patients and observed prevalence of each genotype and
genotypes summary provide a summary of association of mutations to
genotypes; finally log likelihood and error rates return the likelihood
of the inferred phylogenetic moldel and best values of alpha and beta as
estimated by VERSO.</p>
<p>We can plot the inferred phylogetic tree using the function plot from
the package ape.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">inference</span><span class="op">$</span><span class="va">phylogenetic_tree</span><span class="op">)</span></span></code></pre></div>
<p><img src="v2_running_VERSO_files/figure-html/unnamed-chunk-5-1.png" width="1152"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daniele Ramazzotti, Fabrizio Angaroni, Davide Maspero, Alex Graudenzi, Luca De Sano.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
